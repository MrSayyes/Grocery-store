# 分布式锁

> JUC：sync+lock（单机锁）
>
> 加锁1：N，即一个jvm：多个线程

sync+lock不适应多机

> 集群M：N，即多个jvm：多个线程

**所以在集群，使用分布式锁，同一时间只允许一个jvm去做。**

三个常规方案

## 1、Mysql数据库乐观锁实现

## 2、Redis

## 3、Zookeeper

1）原理：使用事件通知和监听，多机谁抢到谁在Zookeeper上面建临时节点（不可重复建），执行完删除节点，可以重新抢建临时节点。

2）命令：

- 删除：delete [路径] 

- 创建：create [路径] [值]  

3）节点：持久、临时，细分还有带序号的持久节点、带序号的临时节点。

默认创建持久节点，创建临时节点需要如下命令：

> -e：临时
>
> -p：持久
>
> -es：带序号的临时节点
>
> -qs：带序号的持久节点

create -e [路径] [值]













